<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI LogicLog v2.2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;700;900&display=swap');
        body { font-family: 'Pretendard', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.2); border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { 
            History, PlusCircle, Calendar, TrendingUp, ClipboardList, Lock, 
            ChevronLeft, ChevronRight, User, Trash2, Clock, Search, 
            BarChart3, AlertCircle, Info, Zap, MessageSquareQuote, 
            BrainCircuit, ShieldCheck 
        } = lucide;

        const PROFESSOR_PASSWORD = "2026";
        const STORAGE_KEY = "ai_logic_log_data_2026";

        function App() {
            const [view, setView] = useState('home'); 
            const [logs, setLogs] = useState([]);
            const [role, setRole] = useState('student');
            const [isProfAuth, setIsProfAuth] = useState(false);
            const [passInput, setPassInput] = useState("");
            const [loading, setLoading] = useState(false);

            const [formData, setFormData] = useState({
                studentName: '', studentId: '', assignmentTitle: '', 
                step: 'idea', aiTool: '', prompt: '', 
                criticalReflection: '', logDate: new Date().toISOString().split('T')[0]
            });

            useEffect(() => {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) setLogs(JSON.parse(savedData));
            }, []);

            const saveLog = (e) => {
                e.preventDefault();
                setLoading(true);
                const newLog = { ...formData, id: Date.now().toString(), createdAt: new Date().toISOString() };
                const updatedLogs = [newLog, ...logs];
                setLogs(updatedLogs);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedLogs));
                setTimeout(() => {
                    setLoading(false);
                    alert("성공적으로 기록되었습니다.");
                    setView('myLogs');
                }, 500);
            };

            const deleteLog = (id) => {
                if (window.confirm("이 사고 로그를 삭제하시겠습니까?")) {
                    const updated = logs.filter(l => l.id !== id);
                    setLogs(updated);
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));
                }
            };

            const verifyProfessor = (e) => {
                e.preventDefault();
                if (passInput === PROFESSOR_PASSWORD) {
                    setIsProfAuth(true);
                    setView('dashboard');
                } else {
                    alert("암호가 일치하지 않습니다.");
                }
            };

            // 네비게이션 바 디자인
            const Nav = () => (
                <nav className="bg-white border-b border-slate-100 sticky top-0 z-40 shadow-sm backdrop-blur-md bg-white/80">
                    <div className="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
                        <div className="flex items-center gap-2 cursor-pointer group" onClick={() => setView('home')}>
                            <div className="bg-indigo-600 p-2 rounded-xl text-white group-hover:rotate-12 transition-transform">
                                <History className="w-5 h-5" />
                            </div>
                            <span className="font-bold text-xl tracking-tighter text-indigo-950">AI LogicLog <span className="text-xs font-normal text-slate-300 ml-1 italic">v2.2</span></span>
                        </div>
                        <div className="flex items-center gap-4">
                            {role === 'student' && (
                                <button onClick={() => setView('myLogs')} className={`flex items-center gap-2 px-3 py-2 rounded-xl text-sm font-bold transition ${view === 'myLogs' ? 'bg-indigo-50 text-indigo-700' : 'text-slate-500 hover:bg-slate-50'}`}>
                                    <TrendingUp className="w-4 h-4" /> 내 성장 기록
                                </button>
                            )}
                            <button onClick={() => setView('calendar')} className={`flex items-center gap-2 px-3 py-2 rounded-xl text-sm font-bold transition ${view === 'calendar' ? 'bg-indigo-50 text-indigo-700' : 'text-slate-500 hover:bg-slate-50'}`}>
                                <Calendar className="w-4 h-4" /> 기록 달력
                            </button>
                            <select 
                                value={role} 
                                onChange={(e) => {setRole(e.target.value); setIsProfAuth(false); setView('home');}}
                                className="bg-slate-50 border-none rounded-xl px-3 py-2 text-xs font-bold outline-none cursor-pointer"
                            >
                                <option value="student">학생 모드</option>
                                <option value="professor">교수자 모드</option>
                            </select>
                        </div>
                    </div>
                </nav>
            );

            return (
                <div className="min-h-screen bg-[#F8FAFF] text-slate-900 selection:bg-indigo-100">
                    <Nav />
                    <main className="max-w-6xl mx-auto px-6 py-8">
                        {role === 'professor' && !isProfAuth ? (
                            <div className="max-w-md mx-auto mt-20 p-10 bg-white rounded-[2.5rem] shadow-2xl border border-slate-100 text-center space-y-8 animate-in zoom-in-95 duration-500">
                                <div className="bg-indigo-50 w-20 h-20 rounded-full flex items-center justify-center mx-auto text-indigo-600"><Lock className="w-10 h-10" /></div>
                                <div className="space-y-2">
                                    <h2 className="text-3xl font-black text-slate-900">교수자 인증</h2>
                                    <p className="text-slate-500 text-sm">암호를 입력하여 전체 로그에 접속하세요.</p>
                                </div>
                                <form onSubmit={verifyProfessor} className="space-y-4">
                                    <input type="password" value={passInput} onChange={e => setPassInput(e.target.value)} placeholder="Password"
                                        className="w-full px-6 py-4 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-500/10 outline-none text-center text-2xl tracking-[0.5em]" />
                                    <button type="submit" className="w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold text-lg hover:bg-indigo-700 transition shadow-xl">대시보드 접속</button>
                                </form>
                            </div>
                        ) : (
                            <div className="animate-in fade-in duration-500">
                                {view === 'home' && <HomeView role={role} setView={setView} />}
                                {view === 'log' && <LogFormView formData={formData} setFormData={setFormData} onSave={saveLog} loading={loading} setView={setView} />}
                                {view === 'dashboard' && <ProfessorDashboard logs={logs} deleteLog={deleteLog} />}
                                {view === 'calendar' && <CalendarView logs={logs} />}
                                {view === 'myLogs' && <StudentGrowthView logs={logs} defaultInfo={{ name: formData.studentName, id: formData.studentId }} />}
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        // --- 컴포넌트: HomeView ---
        function HomeView({ role, setView }) {
            return (
                <div className="py-20 text-center space-y-12 max-w-4xl mx-auto">
                    <div className="space-y-6">
                        <div className="inline-block px-4 py-1.5 bg-indigo-50 text-indigo-600 rounded-full text-xs font-black tracking-widest uppercase">2026 AI Ethics & Critical Thinking</div>
                        <h1 className="text-6xl font-black text-slate-900 tracking-tight leading-[1.1]">AI를 활용하는 당신의 <br /><span className="text-indigo-600">논리적 궤적</span>을 남기세요</h1>
                        <p className="text-xl text-slate-500 leading-relaxed font-medium">어떤 도구를 썼는지보다 어떻게 질문하고 무엇을 걸러냈는지가 더 중요합니다.</p>
                    </div>
                    <div className="flex flex-wrap justify-center gap-4">
                        {role === 'student' ? (
                            <>
                                <button onClick={() => setView('log')} className="bg-indigo-600 text-white px-10 py-5 rounded-[2rem] font-bold text-xl hover:bg-indigo-700 shadow-2xl shadow-indigo-100 flex items-center gap-3 transition-all hover:scale-105">
                                    <PlusCircle className="w-6 h-6" /> 새 로그 기록하기
                                </button>
                                <button onClick={() => setView('myLogs')} className="bg-white border-2 border-slate-100 text-slate-700 px-10 py-5 rounded-[2rem] font-bold text-xl hover:bg-slate-50 shadow-sm flex items-center gap-3 transition-all hover:scale-105">
                                    <TrendingUp className="w-6 h-6 text-indigo-600" /> 성장 타임라인 보기
                                </button>
                            </>
                        ) : (
                            <button onClick={() => setView('dashboard')} className="bg-slate-900 text-white px-12 py-5 rounded-[2rem] font-bold text-xl hover:bg-black shadow-2xl flex items-center gap-3 transition-all hover:scale-105">
                                <ClipboardList className="w-6 h-6" /> 전체 과정 모니터링
                            </button>
                        )}
                    </div>
                    <div className="grid md:grid-cols-3 gap-8 text-left pt-16">
                        <FeatureCard icon={<MessageSquareQuote className="text-indigo-600" />} title="프롬프트 기록" desc="AI에게 입력한 원문을 그대로 보관하여 질문의 발전 과정을 추적합니다." />
                        <FeatureCard icon={<Zap className="text-amber-500" />} title="비판적 필터링" desc="AI 답변 중 틀린 부분이나 수정된 본인의 견해를 명시하여 사유를 증명합니다." />
                        <FeatureCard icon={<BarChart3 className="text-emerald-500" />} title="기록 보존" desc="작성된 모든 데이터는 브라우저의 LocalStorage에 안전하게 저장됩니다." />
                    </div>
                </div>
            );
        }

        // --- 컴포넌트: LogFormView ---
        function LogFormView({ formData, setFormData, onSave, loading, setView }) {
            const STEPS = [{id:'idea', label:'아이디어'}, {id:'outline', label:'개요작성'}, {id:'draft', label:'초안작성'}, {id:'fact-check', label:'사실확인'}, {id:'editing', label:'최종편집'}];
            return (
                <div className="max-w-4xl mx-auto bg-white rounded-[2.5rem] shadow-2xl shadow-indigo-100/50 border border-slate-100 overflow-hidden">
                    <div className="bg-indigo-600 p-10 text-white relative">
                        <h2 className="text-4xl font-black tracking-tight">AI 상호작용 로그</h2>
                        <p className="text-indigo-100 mt-2 text-lg font-medium">당신의 사고 과정은 정직한 기록에서 증명됩니다.</p>
                        <BrainCircuit className="absolute -right-10 -top-10 w-64 h-64 text-white opacity-10 rotate-12" />
                    </div>
                    <form onSubmit={onSave} className="p-10 space-y-10">
                        <div className="grid md:grid-cols-2 gap-8 bg-slate-50/50 p-8 rounded-[2rem] border border-slate-100 shadow-inner">
                            <div className="space-y-2">
                                <label className="text-xs font-black text-slate-400 uppercase tracking-widest ml-1">작성자 성함</label>
                                <input required value={formData.studentName} onChange={e=>setFormData({...formData, studentName:e.target.value})} className="w-full px-6 py-4 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-500/10 outline-none" />
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-black text-slate-400 uppercase tracking-widest ml-1">학번</label>
                                <input required value={formData.studentId} onChange={e=>setFormData({...formData, studentId:e.target.value})} className="w-full px-6 py-4 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-500/10 outline-none" />
                            </div>
                        </div>
                        <div className="grid md:grid-cols-2 gap-8">
                            <div className="space-y-6">
                                <div className="space-y-2">
                                    <label className="text-xs font-black text-slate-400 uppercase tracking-widest ml-1">과제 제목</label>
                                    <input required value={formData.assignmentTitle} onChange={e=>setFormData({...formData, assignmentTitle:e.target.value})} className="w-full px-6 py-4 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-500/10 outline-none" />
                                </div>
                                <div className="space-y-3">
                                    <label className="text-xs font-black text-slate-400 uppercase tracking-widest ml-1">진행 단계</label>
                                    <div className="grid grid-cols-5 gap-2">
                                        {STEPS.map(s => (
                                            <button key={s.id} type="button" onClick={()=>setFormData({...formData, step:s.id})} className={`py-2 rounded-xl text-[10px] font-black border transition ${formData.step===s.id ? 'bg-indigo-600 text-white border-indigo-600 shadow-lg' : 'bg-white text-slate-400 border-slate-200'}`}>{s.label}</button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                            <div className="space-y-6">
                                <div className="space-y-2">
                                    <label className="text-xs font-black text-slate-400 uppercase tracking-widest ml-1">입력 프롬프트</label>
                                    <textarea required rows="4" value={formData.prompt} onChange={e=>setFormData({...formData, prompt:e.target.value})} className="w-full px-5 py-4 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-500/10 outline-none resize-none" />
                                </div>
                                <div className="space-y-2">
                                    <label className="text-sm font-black text-indigo-600 flex items-center gap-1 uppercase tracking-wide"><Zap className="w-4 h-4" /> 비판적 성찰 및 재구성</label>
                                    <textarea required rows="4" value={formData.criticalReflection} onChange={e=>setFormData({...formData, criticalReflection:e.target.value})} className="w-full px-5 py-4 rounded-2xl border-2 border-indigo-100 bg-indigo-50/20 focus:ring-4 focus:ring-indigo-500/10 outline-none resize-none" />
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-4 pt-6">
                            <button type="button" onClick={()=>setView('home')} className="flex-1 py-5 text-slate-400 font-bold">취소</button>
                            <button type="submit" className="flex-[3] py-5 bg-indigo-600 text-white rounded-2xl font-bold text-xl hover:bg-indigo-700 shadow-xl transition-all">로그 저장 및 기록 확인</button>
                        </div>
                    </form>
                </div>
            );
        }

        // --- 컴포넌트: StudentGrowthView ---
        function StudentGrowthView({ logs, defaultInfo }) {
            const [searchName, setSearchName] = useState(defaultInfo.name || "");
            const [searchId, setSearchId] = useState(defaultInfo.id || "");
            const [isSearched, setIsSearched] = useState(!!(defaultInfo.name && defaultInfo.id));
            const myLogs = useMemo(() => logs.filter(l => l.studentName === searchName && l.studentId === searchId).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)), [logs, searchName, searchId]);

            return (
                <div className="space-y-10 max-w-5xl mx-auto">
                    <div className="bg-white p-8 rounded-[2rem] border border-slate-200 shadow-sm flex flex-col md:flex-row gap-6 items-center justify-between">
                        <div className="text-left">
                            <h2 className="text-3xl font-black text-slate-900 tracking-tight">성장 타임라인</h2>
                            <p className="text-slate-500 mt-1 font-medium">당신이 쌓아온 사고의 궤적을 확인하세요.</p>
                        </div>
                        <div className="flex gap-2 w-full md:w-auto">
                            <input value={searchName} onChange={e=>setSearchName(e.target.value)} placeholder="이름" className="flex-1 md:w-32 px-4 py-3 rounded-xl border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500" />
                            <input value={searchId} onChange={e=>setSearchId(e.target.value)} placeholder="학번" className="flex-1 md:w-40 px-4 py-3 rounded-xl border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500" />
                            <button onClick={()=>setIsSearched(true)} className="bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-indigo-700"><Search className="w-5 h-5" /></button>
                        </div>
                    </div>
                    {isSearched && myLogs.length > 0 ? (
                        <div className="space-y-8 relative pl-0 sm:pl-10">
                            <div className="absolute left-4 top-0 bottom-0 w-1 bg-indigo-50 hidden sm:block" />
                            {myLogs.map(log => (
                                <div key={log.id} className="relative bg-white p-8 rounded-[2.5rem] border border-slate-200 shadow-sm hover:border-indigo-300 transition-all text-left">
                                    <div className="absolute -left-10 top-10 w-4 h-4 rounded-full bg-indigo-600 border-4 border-white shadow-md hidden sm:block" />
                                    <div className="flex justify-between items-start mb-6">
                                        <div>
                                            <span className="text-[10px] font-black tracking-widest uppercase bg-indigo-50 text-indigo-600 px-3 py-1 rounded-lg">{log.step}</span>
                                            <h4 className="text-2xl font-black text-slate-900 mt-2">{log.assignmentTitle}</h4>
                                        </div>
                                        <div className="text-xs font-bold text-slate-400 bg-slate-50 px-3 py-1.5 rounded-full">{log.logDate}</div>
                                    </div>
                                    <div className="space-y-4">
                                        <div className="bg-slate-50 p-4 rounded-xl italic text-sm text-slate-600">"{log.prompt}"</div>
                                        <div className="bg-indigo-50/50 p-5 rounded-xl text-sm text-slate-800 border border-indigo-100">{log.criticalReflection}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    ) : (
                        <div className="py-20 text-center opacity-30"><History className="w-20 h-20 mx-auto mb-4" /><p>기록을 조회해 보세요.</p></div>
                    )}
                </div>
            );
        }

        // --- 기타 서브 컴포넌트 ---
        function FeatureCard({icon, title, desc}) {
            return (
                <div className="bg-white p-10 rounded-[2.5rem] border border-slate-100 shadow-sm hover:shadow-xl transition-all">
                    <div className="bg-slate-50 w-16 h-16 rounded-[1.5rem] flex items-center justify-center mb-6 text-2xl shadow-inner">{icon}</div>
                    <h3 className="font-black text-2xl mb-3 tracking-tight text-slate-900">{title}</h3>
                    <p className="text-slate-500 leading-relaxed text-sm font-medium">{desc}</p>
                </div>
            );
        }

        function CalendarView({logs}) { return <div className="py-40 text-center bg-white rounded-[3rem] border border-dashed border-slate-200 text-slate-300 font-bold">캘린더 뷰는 추후 업데이트 예정입니다.</div> }
        
        function ProfessorDashboard({logs, deleteLog}) {
            return (
                <div className="space-y-10 text-left">
                    <header className="flex justify-between items-center">
                        <div>
                            <h2 className="text-4xl font-black text-slate-900">전체 사고 모니터링</h2>
                            <p className="text-slate-500 mt-1">현재 브라우저에 저장된 전체 {logs.length}건의 데이터를 확인합니다.</p>
                        </div>
                        <div className="bg-indigo-600 text-white px-5 py-2.5 rounded-2xl text-sm font-black flex items-center gap-2 shadow-lg"><ShieldCheck className="w-5 h-5" /> Admin Verified</div>
                    </header>
                    <div className="grid gap-6">
                        {logs.map(log => (
                            <div key={log.id} className="bg-white p-8 rounded-[2rem] border border-slate-200 flex justify-between items-center hover:shadow-lg transition-all">
                                <div>
                                    <div className="flex items-center gap-3 mb-2">
                                        <span className="font-black text-lg">{log.studentName} ({log.studentId})</span>
                                        <span className="text-[10px] font-black uppercase bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded">{log.step}</span>
                                    </div>
                                    <h4 className="font-bold text-slate-500">{log.assignmentTitle}</h4>
                                </div>
                                <button onClick={()=>deleteLog(log.id)} className="text-slate-200 hover:text-red-500 p-3 transition-colors"><Trash2 className="w-6 h-6" /></button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
